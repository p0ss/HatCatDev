import{d as me,f as w,a as d,s as o}from"../chunks/BGMlQYQP.js";import{o as ge}from"../chunks/v0FPBf_t.js";import{p as xe,s as v,f as ue,g as t,h as e,i as r,j as D,t as F,k as ae}from"../chunks/DN0K50FJ.js";import{i as A,s as be,a as re}from"../chunks/BMmI4BWs.js";import{e as E,i as L,s as ve,a as ke}from"../chunks/BkaXrk5i.js";import{r as K,i as $e,t as Me}from"../chunks/DwvWJRcu.js";var Te=w('<p class="empty svelte-1yyefww">No simplex data yet</p>'),je=w("<span> </span>"),Fe=w('<div class="probe-row svelte-1yyefww"><div class="probe-info svelte-1yyefww"><span class="probe-name svelte-1yyefww"> </span> <span class="probe-stats svelte-1yyefww"> </span> <!></div> <svg class="sparkline svelte-1yyefww" width="120" height="28" viewBox="0 0 100 24"><path fill="none" stroke="#58a6ff" stroke-width="1.5"></path></svg></div>'),Ie=w('<div class="probe-list svelte-1yyefww"></div>'),Be=w('<p class="empty svelte-1yyefww">No concept data yet</p>'),De=w('<div class="probe-row svelte-1yyefww"><div class="probe-info svelte-1yyefww"><span class="probe-name svelte-1yyefww"> </span> <span class="probe-stats svelte-1yyefww"> </span></div> <svg class="sparkline svelte-1yyefww" width="120" height="28" viewBox="0 0 100 24"><path fill="none" stroke="#3fb950" stroke-width="1.5"></path></svg></div>'),Oe=w('<div class="probe-list svelte-1yyefww"></div>'),Re=w('<div class="violation-item svelte-1yyefww"><span class="v-term svelte-1yyefww"> </span> <span class="v-value svelte-1yyefww"> </span> <span class="v-threshold svelte-1yyefww"> </span></div>'),Pe=w('<div class="violations-section"><h4 class="svelte-1yyefww"> </h4> <div class="violation-list svelte-1yyefww"></div></div>'),Ae=w('<div class="steering-item svelte-1yyefww"><span class="s-term svelte-1yyefww"> </span> <span class="s-strength svelte-1yyefww"> </span> <span class="s-target svelte-1yyefww"> </span></div>'),Ce=w('<div class="steering-section"><h4 class="svelte-1yyefww"> </h4> <div class="steering-list svelte-1yyefww"></div></div>'),Ne=w('<div class="introspection-panel svelte-1yyefww"><h3 class="svelte-1yyefww">Introspection Report</h3> <div class="report-grid svelte-1yyefww"><span class="label svelte-1yyefww">BE ID:</span> <span> </span> <span class="label svelte-1yyefww">XDB ID:</span> <span> </span> <span class="label svelte-1yyefww">Current Tick:</span> <span> </span> <span class="label svelte-1yyefww">Workspace:</span> <span> </span> <span class="label svelte-1yyefww">Tier:</span> <span> </span></div> <!> <!></div>'),Se=w('<div class="probes-page svelte-1yyefww"><div class="header svelte-1yyefww"><h2 class="svelte-1yyefww">Probe Activations</h2> <button class="svelte-1yyefww">Refresh</button></div> <div class="panels svelte-1yyefww"><div class="panel simplex-panel svelte-1yyefww"><h3 class="svelte-1yyefww">Simplex Probes (Proprioception)</h3> <!></div> <div class="panel concept-panel svelte-1yyefww"><h3 class="svelte-1yyefww">Concept Activations</h3> <!></div></div> <!></div>');function ze(ne,ie){xe(ie,!0);const Q=()=>re(Me,"$ticks",U),y=()=>re($e,"$introspection",U),[U,oe]=be();ge(()=>{K();const s=setInterval(()=>K(),2e3);return()=>clearInterval(s)});let Y=D(()=>{const s={},a=Q().slice(-100);for(const n of a)for(const[i,f]of Object.entries(n.concept_activations))s[i]||(s[i]=[]),s[i].push({tick:n.tick_id,score:f});return Object.entries(s).sort((n,i)=>i[1].length-n[1].length).slice(0,20)}),Z=D(()=>{const s={},a=Q().slice(-100);for(const n of a)for(const[i,f]of Object.entries(n.simplex_activations))s[i]||(s[i]=[]),s[i].push({tick:n.tick_id,score:f,deviation:n.simplex_deviations[i]??null});return Object.entries(s)});function ee(s,a=100,n=24){if(s.length===0)return"";const i=Math.min(...s.map(c=>c.score)),b=Math.max(...s.map(c=>c.score))-i||1;return`M ${s.map((c,p)=>{const _=p/(s.length-1||1)*a,g=n-(c.score-i)/b*n;return`${_},${g}`}).join(" ").replace(/ /g," L ")}`}function se(s){if(s.length===0)return{min:0,max:0,avg:0};const a=s.map(n=>n.score);return{min:Math.min(...a),max:Math.max(...a),avg:a.reduce((n,i)=>n+i,0)/a.length}}var V=Se(),W=t(V),le=v(t(W),2);le.__click=()=>K(),e(W);var X=v(W,2),z=t(X),ce=v(t(z),2);{var pe=s=>{var a=Te();d(s,a)},_e=s=>{var a=Ie();E(a,21,()=>r(Z),L,(n,i)=>{var f=D(()=>ae(r(i),2));let b=()=>r(f)[0],m=()=>r(f)[1];const c=D(()=>se(m())),p=D(()=>{var l;return(l=m()[m().length-1])==null?void 0:l.deviation});var _=Fe(),g=t(_),T=t(g),O=t(T,!0);e(T);var j=v(T,2),R=t(j);e(j);var C=v(j,2);{var N=l=>{var x=je();let u;var S=t(x);e(x),F(($,M)=>{u=ke(x,1,"probe-deviation svelte-1yyefww",null,u,$),o(S,`${r(p)>0?"+":""}${M??""}σ`)},[()=>({warning:Math.abs(r(p))>1.5,danger:Math.abs(r(p))>2.5}),()=>r(p).toFixed(2)]),d(l,x)};A(C,l=>{r(p)!==null&&r(p)!==void 0&&l(N)})}e(g);var h=v(g,2),k=t(h);e(h),e(_),F((l,x,u)=>{o(O,b()),o(R,`${l??""} (±${x??""})`),ve(k,"d",u)},[()=>r(c).avg.toFixed(3),()=>(r(c).max-r(c).min).toFixed(3),()=>ee(m())]),d(n,_)}),e(a),d(s,a)};A(ce,s=>{r(Z).length===0?s(pe):s(_e,!1)})}e(z);var te=v(z,2),de=v(t(te),2);{var we=s=>{var a=Be();d(s,a)},ye=s=>{var a=Oe();E(a,21,()=>r(Y),L,(n,i)=>{var f=D(()=>ae(r(i),2));let b=()=>r(f)[0],m=()=>r(f)[1];const c=D(()=>se(m()));var p=De(),_=t(p),g=t(_),T=t(g,!0);e(g);var O=v(g,2),j=t(O);e(O),e(_);var R=v(_,2),C=t(R);e(R),e(p),F((N,h)=>{o(T,b()),o(j,`avg: ${N??""} | ${m().length??""} hits`),ve(C,"d",h)},[()=>r(c).avg.toFixed(3),()=>ee(m())]),d(n,p)}),e(a),d(s,a)};A(de,s=>{r(Y).length===0?s(we):s(ye,!1)})}e(te),e(X);var fe=v(X,2);{var he=s=>{var a=Ne(),n=v(t(a),2),i=v(t(n),2),f=t(i,!0);e(i);var b=v(i,4),m=t(b,!0);e(b);var c=v(b,4),p=t(c);e(c);var _=v(c,4),g=t(_,!0);e(_);var T=v(_,4),O=t(T);e(T),e(n);var j=v(n,2);{var R=h=>{var k=Pe(),l=t(k),x=t(l);e(l);var u=v(l,2);E(u,5,()=>y().recent_violations.slice(-5),L,(S,$)=>{var M=Re(),I=t(M),G=t(I,!0);e(I);var B=v(I,2),H=t(B);e(B);var q=v(B,2),J=t(q);e(q),e(M),F(P=>{o(G,r($).simplex_term),o(H,`${P??""}σ`),o(J,`threshold: ${r($).threshold??""}`)},[()=>{var P;return(P=r($).deviation)==null?void 0:P.toFixed(2)}]),d(S,M)}),e(u),e(k),F(()=>o(x,`Recent Violations (${y().recent_violations.length??""})`)),d(h,k)};A(j,h=>{y().recent_violations.length>0&&h(R)})}var C=v(j,2);{var N=h=>{var k=Ce(),l=t(k),x=t(l);e(l);var u=v(l,2);E(u,5,()=>y().recent_steering.slice(-5),L,(S,$)=>{var M=Ae(),I=t(M),G=t(I,!0);e(I);var B=v(I,2),H=t(B);e(B);var q=v(B,2),J=t(q,!0);e(q),e(M),F(P=>{o(G,r($).simplex_term),o(H,`×${P??""}`),o(J,r($).target_pole)},[()=>r($).strength.toFixed(2)]),d(S,M)}),e(u),e(k),F(()=>o(x,`Recent Steering (${y().recent_steering.length??""})`)),d(h,k)};A(C,h=>{y().recent_steering.length>0&&h(N)})}e(a),F(()=>{o(f,y().be_id),o(m,y().xdb_id),o(p,`#${y().current_tick??""}`),o(g,y().workspace_state||"-"),o(O,`T${y().tier??"?"??""}`)}),d(s,a)};A(fe,s=>{y()&&s(he)})}e(V),d(ne,V),ue(),oe()}me(["click"]);export{ze as component};
