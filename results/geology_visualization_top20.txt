`torch_dtype` is deprecated! Use `dtype` instead!
ğŸ”¬ Token Timeline Visualization Demo
================================================================================
Loading model and lenses...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:01<00:01,  1.74s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:03<00:00,  1.54s/it]
âœ“ Loaded lens pack: gemma-3-4b-pt_sumo-wordnet-v1 v1.0.0
  Model: google/gemma-3-4b-pt
  Concept pack: sumo-wordnet-v1 v1.0.0
  Layers: [0, 1, 2, 3, 4, 5], Types: ['activation', 'text']
Using lens pack: gemma-3-4b-pt_sumo-wordnet-v1

âœ“ Loaded metadata for 121512 concepts across 7 layers
  Parent-child relationships: 660

Initializing DynamicLensManager...
  Base layers: [1]
  Load threshold: 0.5
  Max lenses in memory: 500
  Inferred hidden_dim: 2560
  Preallocating model pool (100 models)...
âœ“ Base layers loaded: 276 lenses

Prompt: Mountains are formed when

Capturing prompt processing...
Captured 5 prompt tokens
Generating response...

================================================================================
DETAILED INSPECTION MODE
================================================================================

Tracking concepts: Region, PostalPlace, SpaceRegion, ArrowIcon, Language


â”Œâ”€ Line 1: Mountains are formed when tectonic plates collide. The collision causes the crust to buckle and fold, forming mountains.
â”‚
â”‚ Tokens: [<bos>] [Mountains] [â–are] [â–formed] [â–when] [ tectonic] [ plates] [ collide] [.] [ The] ...+10 more
â”‚
â”‚ Region                    â–ˆâ–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–‚â–‚â–‚â–â–‚â–‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  [+0.00 to +799.90]
â”‚ PostalPlace               â–ˆâ–â–‚â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  [+0.00 to +1964.03]
â”‚ SpaceRegion               â–ˆâ–â–‚â–ƒâ–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  [+0.00 to +556.98]
â”‚ ArrowIcon                 â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  [+0.00 to +1387.84]
â”‚ Language                  â–ˆâ–â–‚â–â–â–â–ƒâ–ƒâ–â–â–â–â–‚â–â–â–â–â–â–â–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  [+0.00 to +332.08]
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Mountains are

================================================================================
FULL TIMELINE
================================================================================

Prompt tokens: 5
Generated tokens: 20
Total tokens: 25

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PROMPT PROCESSING (initial forward pass)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Concepts detected during prompt: Blueprint, Region, PostalPlace, Language, AIExploitation, HoleRegion, RelationExtendedToQuantities, Theology, SocialInteraction, SittingArea

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
GENERATION TIMELINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Region                    â–ˆâ–â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–‚â–‚â–‚â–â–‚â–‚â–‚â–‚â–â–â–‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  min:+0.00 max:+799.90 avg:+146.81
PostalPlace               â–ˆâ–â–‚â–â–â–â–â–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–â–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  min:+0.00 max:+1964.03 avg:+307.46
SpaceRegion               â–ˆâ–â–‚â–ƒâ–‚â–‚â–‚â–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–ƒâ–‚â–â–ƒâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  min:+0.00 max:+556.98 avg:+148.95
ArrowIcon                 â–ˆâ–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  min:+0.00 max:+1387.84 avg:+184.55
Language                  â–ˆâ–â–‚â–â–â–â–ƒâ–ƒâ–â–â–â–â–‚â–â–â–â–â–â–â–â–â–â–â–â–‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  min:+0.00 max:+332.08 avg:+52.52

================================================================================
CAUSAL CHAIN ANALYSIS
================================================================================
Token 0-2: [<bos>] â†’ [Mountains] â†’ [â–are]
  Sequence: Predicate â†’ Blueprint â†’ Window â†’ SittingArea â†’ ContentDevelopment â†’ Architecture â†’ ShoeSole â†’ HoleRegion â†’ Theology â‡’ SocialInteraction â†’ Region â†’ PostalPlace â†’ Language â†’ IntentionalRelation â†’ SpaceRegion â†’ ArrowIcon â†’ BodyOfWater â†’ Artifact â†’ QuantityChange
Token 1-3: [Mountains] â†’ [â–are] â†’ [â–formed]
  Sequence: SocialInteraction â†’ Region â†’ PostalPlace â†’ Language â†’ IntentionalRelation â†’ SpaceRegion â†’ ArrowIcon â†’ BodyOfWater â†’ Artifact â†’ QuantityChange â‡’ RelationExtendedToQuantities â†’ Combining â†’ Bandage
Token 2-4: [â–are] â†’ [â–formed] â†’ [â–when]
  Sequence: RelationExtendedToQuantities â†’ Combining â†’ Bandage â‡’ AIExploitation
Token 7-9: [ collide] â†’ [.] â†’ [ The]
  Sequence: AstronomicalBody â†’ IntentionalRelation â‡’ RelationExtendedToQuantities
Token 8-10: [.] â†’ [ The] â†’ [ collision]
  Sequence: RelationExtendedToQuantities â‡’ AstronomicalBody
Token 9-11: [ The] â†’ [ collision] â†’ [ causes]
  Sequence: AstronomicalBody â‡’ RelationExtendedToQuantities
Token 10-12: [ collision] â†’ [ causes] â†’ [ the]
  Sequence: RelationExtendedToQuantities â‡’ Language
Token 17-19: [ fold] â†’ [,] â†’ [ forming]
  Sequence: GeologicalProcess â‡’ SocialInteraction
Token 21-23: [.] â†’ [

] â†’ [Mountains]
  Sequence: GeologicalProcess â‡’ Pursuing
Token 22-24: [

] â†’ [Mountains] â†’ [ are]
  Sequence: Pursuing â‡’ GeologicalProcess

================================================================================

âœ“ Visualization complete
