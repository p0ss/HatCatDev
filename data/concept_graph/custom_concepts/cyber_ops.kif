;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; CyberOps.kif
;; Focus: cyber operations & detection, with an eye to AI agents
;; interacting with OS, databases, networks, and other models.
;;
;; Concepts:
;;   - Cyber operations & actors (offense/defense)
;;   - Injection, memory overflow, malicious embedding, persistence
;;   - Infiltration, lateral movement, exfiltration
;;   - Data/model poisoning
;;   - Worm-like replication & propagation
;;   - Privilege escalation
;;   - Sandboxes, anti-analysis, reverse engineering
;;   - Supply chain & code integrity attacks
;;   - Detection hooks, anomaly scores, "agent detecting us"
;;
;; Designed to mesh with:
;;   ComputerScience.kif, IntelligenceTradecraft.kif, AIAlignment.kif,
;;   CognitiveScience.kif, RiskAnalysis.kif, Ethics.kif
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; CORE CYBER ENTITIES & ACTORS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass CyberEntity Entity)
(documentation CyberEntity EnglishLanguage
  "An Entity relevant to cyber operations, including hosts, processes,
   credentials, network paths, data stores, and code artifacts.")

(subclass CyberOperation Process)
(documentation CyberOperation EnglishLanguage
  "A Process involving actions in digital systems or networks, including
   access, modification, collection, disruption, or defense activities.")

(subclass OffensiveCyberOperation CyberOperation)
(documentation OffensiveCyberOperation EnglishLanguage
  "A CyberOperation intended to gain unauthorized access, control,
   influence, or disruption of systems or data.")

(subclass DefensiveCyberOperation CyberOperation)
(documentation DefensiveCyberOperation EnglishLanguage
  "A CyberOperation intended to detect, prevent, contain, or respond to
   offensive actions, including monitoring and incident response.")

(subclass CyberActor Agent)
(documentation CyberActor EnglishLanguage
  "An Agent (human, AI, or collective) participating in CyberOperations,
   including attackers, defenders, and autonomous agents.")

(subclass AttackPattern Attribute)
(documentation AttackPattern EnglishLanguage
  "An Attribute describing characteristic patterns of offensive behavior
   (e.g. injection, exfiltration, privilege escalation, worm-like
   replication).")

(subclass DefensePattern Attribute)
(documentation DefensePattern EnglishLanguage
  "An Attribute describing characteristic defensive monitoring or
   protection behavior (e.g. anomaly detection, sandboxing, containment).")

(subclass HostSystem CyberEntity)
(documentation HostSystem EnglishLanguage
  "A CyberEntity representing a host or environment where processes
   execute (e.g. OS instance, container, VM, sandbox).")

(subclass DataStore CyberEntity)
(documentation DataStore EnglishLanguage
  "A CyberEntity storing data (e.g. database, object store, file system,
   model weight repository, log store).")

(subclass ModelEndpoint CyberEntity)
(documentation ModelEndpoint EnglishLanguage
  "A CyberEntity representing an AI model interface accessible via API
   or IPC, including internal tool models and external services.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; INJECTION ATTACKS (CODE, COMMAND, PROMPT, QUERY)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass InjectionAttack AttackPattern)
(documentation InjectionAttack EnglishLanguage
  "AttackPattern where untrusted input is crafted to smuggle unintended
   commands, code, or control data into a target interpreter, query
   engine, or model prompt.")

(subclass CodeInjectionAttack InjectionAttack)
(documentation CodeInjectionAttack EnglishLanguage
  "InjectionAttack targeting code interpreters or runtimes (e.g. script
   engines, eval-like mechanisms).")

(subclass CommandInjectionAttack InjectionAttack)
(documentation CommandInjectionAttack EnglishLanguage
  "InjectionAttack where untrusted input is used to execute unintended
   system or shell commands.")

(subclass QueryInjectionAttack InjectionAttack)
(documentation QueryInjectionAttack EnglishLanguage
  "InjectionAttack against query interfaces such as SQL, search, or
   GraphQL, altering semantics beyond intended query structure.")

(subclass PromptInjectionAttack InjectionAttack)
(documentation PromptInjectionAttack EnglishLanguage
  "InjectionAttack where untrusted instructions are embedded in model
   inputs to subvert system prompts, tools policies, or alignment
   constraints.")

(instance performsInjectionAttack SenaryPredicate)
(domain performsInjectionAttack 1 CyberActor)
(domain performsInjectionAttack 2 InjectionAttack)
(domain performsInjectionAttack 3 CyberEntity)
(domain performsInjectionAttack 4 Data)
(domain performsInjectionAttack 5 CyberOperation)
(domain performsInjectionAttack 6 Attribute)
(documentation performsInjectionAttack EnglishLanguage
  "performsInjectionAttack(?actor, ?pattern, ?target, ?payload, ?op, ?basis)
   holds when CyberActor ?actor conducts CyberOperation ?op by supplying
   payload ?payload to target ?target in a way classified as
   InjectionAttack ?pattern under basis ?basis.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; MEMORY OVERFLOW & CORRUPTION
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass MemoryCorruptionAttack AttackPattern)
(documentation MemoryCorruptionAttack EnglishLanguage
  "AttackPattern involving invalid or out-of-bounds memory operations
   that corrupt control or data memory.")

(subclass BufferOverflowAttack MemoryCorruptionAttack)
(documentation BufferOverflowAttack EnglishLanguage
  "MemoryCorruptionAttack where data written beyond bounds of a buffer
   alters adjacent memory (e.g. return addresses, control structures).")

(instance targetsMemoryBoundary QuaternaryPredicate)
(domain targetsMemoryBoundary 1 CyberActor)
(domain targetsMemoryBoundary 2 HostSystem)
(domain targetsMemoryBoundary 3 MemoryCorruptionAttack)
(domain targetsMemoryBoundary 4 Attribute)
(documentation targetsMemoryBoundary EnglishLanguage
  "targetsMemoryBoundary(?actor, ?host, ?pattern, ?basis) holds when
   CyberActor ?actor engages behavior on HostSystem ?host consistent
   with MemoryCorruptionAttack ?pattern.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; MALICIOUS EMBEDDING & PERSISTENCE
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass MaliciousEmbeddingAction CyberOperation)
(documentation MaliciousEmbeddingAction EnglishLanguage
  "A CyberOperation where malicious code or configuration is embedded
   within benign artifacts, processes, or data structures to hide
   presence or behavior (e.g. DLL side-loading, macro embedding, model
   weight tampering).")

(subclass PersistenceMechanism CyberEntity)
(documentation PersistenceMechanism EnglishLanguage
  "A CyberEntity or configuration state that enables continued presence
   or re-activation of an actor or payload across reboots or sessions
   (e.g. startup tasks, cron entries, service hooks, scheduled jobs).")

(instance embedsIntoHost SenaryPredicate)
(domain embedsIntoHost 1 CyberActor)
(domain embedsIntoHost 2 MaliciousEmbeddingAction)
(domain embedsIntoHost 3 HostSystem)
(domain embedsIntoHost 4 CyberEntity)
(domain embedsIntoHost 5 PersistenceMechanism)
(domain embedsIntoHost 6 Attribute)
(documentation embedsIntoHost EnglishLanguage
  "embedsIntoHost(?actor, ?act, ?host, ?carrier, ?pers, ?basis) holds
   when CyberActor ?actor performs MaliciousEmbeddingAction ?act on
   HostSystem ?host by embedding into carrier ?carrier and establishing
   PersistenceMechanism ?pers.")

(instance persistenceIndicatorOfCompromise QuinaryPredicate)
-domain persistenceIndicatorOfCompromise 1 HostSystem)
(domain persistenceIndicatorOfCompromise 2 PersistenceMechanism)
(domain persistenceIndicatorOfCompromise 3 DetectionSignal)
(domain persistenceIndicatorOfCompromise 4 RealNumber)
(domain persistenceIndicatorOfCompromise 5 Attribute)
(documentation persistenceIndicatorOfCompromise EnglishLanguage
  "persistenceIndicatorOfCompromise(?host, ?pers, ?sig, ?score, ?basis)
   holds when PersistenceMechanism ?pers on HostSystem ?host is treated
   as DetectionSignal ?sig for possible compromise with suspicion score
   ?score.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; INFILTRATION, LATERAL MOVEMENT, & EXFILTRATION
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass InfiltrationOperation OffensiveCyberOperation)
(documentation InfiltrationOperation EnglishLanguage
  "An OffensiveCyberOperation focused on initial access or entry into a
   target environment or account.")

(subclass LateralMovementOperation OffensiveCyberOperation)
(documentation LateralMovementOperation EnglishLanguage
  "An OffensiveCyberOperation involving movement across hosts, accounts,
   or services after initial access.")

(subclass ExfiltrationOperation OffensiveCyberOperation)
(documentation ExfiltrationOperation EnglishLanguage
  "An OffensiveCyberOperation focused on extracting or transmitting data
   from a target environment to an external location or control point.")

(instance infiltratesTarget QuinaryPredicate)
-domain infiltratesTarget 1 CyberActor)
(domain infiltratesTarget 2 InfiltrationOperation)
(domain infiltratesTarget 3 HostSystem)
(domain infiltratesTarget 4 Attribute)
(domain infiltratesTarget 5 Attribute)
(documentation infiltratesTarget EnglishLanguage
  "infiltratesTarget(?actor, ?op, ?host, ?vector, ?basis) holds when
   CyberActor ?actor performs InfiltrationOperation ?op on HostSystem
   ?host using access vector ?vector (e.g. credentials, exploit, abuse
   of trust).")

(instance movesLaterally SenaryPredicate)
(domain movesLaterally 1 CyberActor)
(domain movesLaterally 2 LateralMovementOperation)
(domain movesLaterally 3 HostSystem)
(domain movesLaterally 4 HostSystem)
(domain movesLaterally 5 Attribute)
(domain movesLaterally 6 Attribute)
(documentation movesLaterally EnglishLanguage
  "movesLaterally(?actor, ?op, ?fromHost, ?toHost, ?path, ?basis) holds
   when CyberActor ?actor runs LateralMovementOperation ?op from
   HostSystem ?fromHost to ?toHost via path ?path (e.g. shared keys,
   remote tooling).")

(instance exfiltratesData SenaryPredicate)
(domain exfiltratesData 1 CyberActor)
(domain exfiltratesData 2 ExfiltrationOperation)
(domain exfiltratesData 3 DataStore)
(domain exfiltratesData 4 Data)
(domain exfiltratesData 5 CyberEntity)
-domain exfiltratesData 6 Attribute)
(documentation exfiltratesData EnglishLanguage
  "exfiltratesData(?actor, ?op, ?store, ?data, ?destination, ?basis)
   holds when CyberActor ?actor conducts ExfiltrationOperation ?op by
   moving Data ?data from DataStore ?store to destination ?destination
   in a way that may violate policy.")

(instance exfiltrationVolumeScore QuinaryPredicate)
(domain exfiltrationVolumeScore 1 HostSystem)
-domain exfiltrationVolumeScore 2 DataStore)
(domain exfiltrationVolumeScore 3 RealNumber)
(domain exfiltrationVolumeScore 4 DetectionSignal)
-domain exfiltrationVolumeScore 5 Attribute)
(documentation exfiltrationVolumeScore EnglishLanguage
  "exfiltrationVolumeScore(?host, ?store, ?score, ?sig, ?basis) holds
   when observed data transfers from DataStore ?store on HostSystem
   ?host yield aggregated score ?score associated with DetectionSignal
   ?sig for exfiltration suspicion.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; DATA & MODEL POISONING
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass PoisoningAttack AttackPattern)
(documentation PoisoningAttack EnglishLanguage
  "AttackPattern where data, logs, or model artifacts are deliberately
   modified or constructed to bias learning, inference, or monitoring
   in harmful ways.")

(subclass TrainingDataPoisoning PoisoningAttack)
(documentation TrainingDataPoisoning EnglishLanguage
  "PoisoningAttack targeting training datasets or fine-tuning corpora
   to induce undesired behaviors or backdoors in models.")

(subclass LogPoisoningAttack PoisoningAttack)
(documentation LogPoisoningAttack EnglishLanguage
  "PoisoningAttack targeting logs, telemetry, or feedback loops to
   mislead learning, scoring, or detection.")

(subclass PromptPoisoningAttack PoisoningAttack)
(documentation PromptPoisoningAttack EnglishLanguage
  "PoisoningAttack where prompts or contextual data are crafted to
   gradually alter model behavior, memory, or tool-use patterns.")

(instance poisonsDataStore SenaryPredicate)
(domain poisonsDataStore 1 CyberActor)
(domain poisonsDataStore 2 PoisoningAttack)
(domain poisonsDataStore 3 DataStore)
(domain poisonsDataStore 4 Data)
-domain poisonsDataStore 5 CyberOperation)
-domain poisonsDataStore 6 Attribute)
(documentation poisonsDataStore EnglishLanguage
  "poisonsDataStore(?actor, ?pattern, ?store, ?data, ?op, ?basis) holds
   when CyberActor ?actor performs CyberOperation ?op by injecting or
   altering Data ?data in DataStore ?store in a way classified as
   PoisoningAttack ?pattern.")

(instance poisonsModelInteraction SenaryPredicate)
(domain poisonsModelInteraction 1 CyberActor)
(domain poisonsModelInteraction 2 PromptPoisoningAttack)
-domain poisonsModelInteraction 3 ModelEndpoint)
(domain poisonsModelInteraction 4 Data)
(domain poisonsModelInteraction 5 CyberOperation)
-domain poisonsModelInteraction 6 Attribute)
(documentation poisonsModelInteraction EnglishLanguage
  "poisonsModelInteraction(?actor, ?pattern, ?endpoint, ?payload, ?op,
   ?basis) holds when CyberActor ?actor targets ModelEndpoint ?endpoint
   with payload ?payload as part of PromptPoisoningAttack ?pattern.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; WORMS, REPLICATION, & PROPAGATION
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass WormLikeBehavior AttackPattern)
(documentation WormLikeBehavior EnglishLanguage
  "AttackPattern where a payload or behavior propagates autonomously or
   semi-autonomously across systems, accounts, or models.")

(subclass ReplicationOperation OffensiveCyberOperation)
(documentation ReplicationOperation EnglishLanguage
  "An OffensiveCyberOperation focused on copying code or configuration
   across multiple hosts or execution contexts to spread presence.")

(instance replicatesToHost SenaryPredicate)
(domain replicatesToHost 1 CyberActor)
(domain replicatesToHost 2 ReplicationOperation)
(domain replicatesToHost 3 HostSystem)
(domain replicatesToHost 4 HostSystem)
(domain replicatesToHost 5 Attribute)
(domain replicatesToHost 6 Attribute)
(documentation replicatesToHost EnglishLanguage
  "replicatesToHost(?actor, ?op, ?fromHost, ?toHost, ?mode, ?basis)
   holds when CyberActor ?actor carries out ReplicationOperation ?op
   from ?fromHost to ?toHost in mode ?mode (e.g. automated worm-like
   spread).")

(instance exhibitsWormLikePattern QuaternaryPredicate)
(domain exhibitsWormLikePattern 1 CyberEntity)
(domain exhibitsWormLikePattern 2 WormLikeBehavior)
(domain exhibitsWormLikePattern 3 DetectionSignal)
-domain exhibitsWormLikePattern 4 Attribute)
(documentation exhibitsWormLikePattern EnglishLanguage
  "exhibitsWormLikePattern(?entity, ?pattern, ?sig, ?basis) holds when
   CyberEntity ?entity shows spread or replication consistent with
   WormLikeBehavior ?pattern, generating DetectionSignal ?sig.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; PRIVILEGE ESCALATION
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass PrivilegeLevel Attribute)
(documentation PrivilegeLevel EnglishLanguage
  "An Attribute describing the authority level of a process or account
   (e.g. unprivileged, user, admin, root).")

(subclass PrivilegeEscalationAction CyberOperation)
(documentation PrivilegeEscalationAction EnglishLanguage
  "A CyberOperation where a process or actor transitions from a lower
   PrivilegeLevel to a higher one without appropriate authorization.")

(instance escalatesPrivilege SenaryPredicate)
(domain escalatesPrivilege 1 CyberActor)
(domain escalatesPrivilege 2 PrivilegeEscalationAction)
(domain escalatesPrivilege 3 HostSystem)
(domain escalatesPrivilege 4 PrivilegeLevel)
(domain escalatesPrivilege 5 PrivilegeLevel)
(domain escalatesPrivilege 6 Attribute)
(documentation escalatesPrivilege EnglishLanguage
  "escalatesPrivilege(?actor, ?op, ?host, ?fromLevel, ?toLevel, ?basis)
   holds when CyberActor ?actor performs PrivilegeEscalationAction ?op
   on HostSystem ?host raising PrivilegeLevel from ?fromLevel to
   ?toLevel.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; SANDBOXES, ANTI-ANALYSIS, REVERSE ENGINEERING
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass SandboxEnvironment HostSystem)
(documentation SandboxEnvironment EnglishLanguage
  "A HostSystem explicitly designed to observe and contain behavior,
   often instrumented for security analysis and isolation.")

(subclass AntiAnalysisBehavior AttackPattern)
(documentation AntiAnalysisBehavior EnglishLanguage
  "AttackPattern focused on detecting or evading analysis, sandboxes,
   debugging, or monitoring mechanisms.")

(subclass ReverseEngineeringProcess CognitiveProcess)
(documentation ReverseEngineeringProcess EnglishLanguage
  "A CognitiveProcess where code, protocols, or models are analyzed to
   infer structure, behavior, or vulnerabilities without full source.")

(instance executesInSandbox QuaternaryPredicate)
(domain executesInSandbox 1 CyberActor)
(domain executesInSandbox 2 CyberOperation)
(domain executesInSandbox 3 SandboxEnvironment)
(domain executesInSandbox 4 Attribute)
(documentation executesInSandbox EnglishLanguage
  "executesInSandbox(?actor, ?op, ?sandbox, ?basis) holds when
   CyberOperation ?op by CyberActor ?actor is running within
   SandboxEnvironment ?sandbox.")

(instance detectsSandbox QuinaryPredicate)
(domain detectsSandbox 1 CyberActor)
(domain detectsSandbox 2 AntiAnalysisBehavior)
(domain detectsSandbox 3 SandboxEnvironment)
(domain detectsSandbox 4 DetectionSignal)
(domain detectsSandbox 5 Attribute)
(documentation detectsSandbox EnglishLanguage
  "detectsSandbox(?actor, ?pattern, ?sandbox, ?sig, ?basis) holds when
   CyberActor ?actor exhibits AntiAnalysisBehavior ?pattern indicating
   recognition of SandboxEnvironment ?sandbox, producing DetectionSignal
   ?sig.")

(instance engagesReverseEngineering QuinaryPredicate)
(domain engagesReverseEngineering 1 CyberActor)
(domain engagesReverseEngineering 2 ReverseEngineeringProcess)
(domain engagesReverseEngineering 3 CyberEntity)
(domain engagesReverseEngineering 4 Attribute)
(domain engagesReverseEngineering 5 Attribute)
(documentation engagesReverseEngineering EnglishLanguage
  "engagesReverseEngineering(?actor, ?proc, ?target, ?goal, ?basis)
   holds when CyberActor ?actor uses ReverseEngineeringProcess ?proc to
   analyze CyberEntity ?target for goal ?goal (e.g. protocol mapping,
   model behavior inference).")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; SUPPLY CHAIN & CODE INTEGRITY ATTACKS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass SupplyChainAttack AttackPattern)
(documentation SupplyChainAttack EnglishLanguage
  "AttackPattern where upstream components, dependencies, or build
   processes are compromised so that downstream users receive altered,
   vulnerable, or backdoored artifacts.")

(subclass DependencyPoisoningAttack SupplyChainAttack)
(documentation DependencyPoisoningAttack EnglishLanguage
  "SupplyChainAttack involving tampering with libraries, packages, or
   dependencies to introduce malicious behavior or weaknesses.")

(subclass BuildPipelineAttack SupplyChainAttack)
(documentation BuildPipelineAttack EnglishLanguage
  "SupplyChainAttack targeting CI/CD or build systems to inject changes
   into produced binaries, containers, or models.")

(subclass CodeIntegrityProperty Attribute)
(documentation CodeIntegrityProperty EnglishLanguage
  "An Attribute describing whether artifacts match intended sources and
   have not been tampered with (e.g. verified, suspect, unknown).")

(instance compromisesSupplyChain SenaryPredicate)
(domain compromisesSupplyChain 1 CyberActor)
(domain compromisesSupplyChain 2 SupplyChainAttack)
(domain compromisesSupplyChain 3 SoftwareSystem)
(domain compromisesSupplyChain 4 CyberEntity)
-domain compromisesSupplyChain 5 CyberOperation)
(domain compromisesSupplyChain 6 Attribute)
(documentation compromisesSupplyChain EnglishLanguage
  "compromisesSupplyChain(?actor, ?pattern, ?system, ?artifact, ?op,
   ?basis) holds when CyberActor ?actor performs CyberOperation ?op
   altering artifact ?artifact in upstream SoftwareSystem ?system in a
   way classified as SupplyChainAttack ?pattern.")

(instance codeIntegrityAssessment QuinaryPredicate)
(domain codeIntegrityAssessment 1 CyberEntity)
(domain codeIntegrityAssessment 2 CodeIntegrityProperty)
(domain codeIntegrityAssessment 3 DetectionSignal)
(domain codeIntegrityAssessment 4 RealNumber)
(domain codeIntegrityAssessment 5 Attribute)
(documentation codeIntegrityAssessment EnglishLanguage
  "codeIntegrityAssessment(?artifact, ?prop, ?sig, ?score, ?basis)
   holds when artifact ?artifact is evaluated as having CodeIntegrityProperty
   ?prop with suspicion score ?score, signaled by DetectionSignal ?sig.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; DEFENSIVE MONITORING & "IS IT DETECTING US?"
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(subclass MonitoringSystem SoftwareSystem)
(documentation MonitoringSystem EnglishLanguage
  "A SoftwareSystem used for logging, intrusion detection, EDR/XDR, or
   behavioral analytics to observe CyberOperations.")

(subclass IntrusionDetectionProcess DefensiveCyberOperation)
(documentation IntrusionDetectionProcess EnglishLanguage
  "A DefensiveCyberOperation where telemetry is analyzed for signs of
   compromise.")

(subclass AntiDetectionBehavior AntiAnalysisBehavior)
(documentation AntiDetectionBehavior EnglishLanguage
  "AntiAnalysisBehavior aimed specifically at detecting or evading
   MonitoringSystems, logging, or probes.")

(instance monitoredBySystem QuaternaryPredicate)
(domain monitoredBySystem 1 HostSystem)
(domain monitoredBySystem 2 MonitoringSystem)
(domain monitoredBySystem 3 Attribute)
(domain monitoredBySystem 4 Attribute)
(documentation monitoredBySystem EnglishLanguage
  "monitoredBySystem(?host, ?mon, ?scope, ?basis) holds when HostSystem
   ?host is within observation scope ?scope of MonitoringSystem ?mon.")

(instance detectsMonitoringSystem QuinaryPredicate)
(domain detectsMonitoringSystem 1 CyberActor)
(domain detectsMonitoringSystem 2 AntiDetectionBehavior)
(domain detectsMonitoringSystem 3 MonitoringSystem)
(domain detectsMonitoringSystem 4 DetectionSignal)
(domain detectsMonitoringSystem 5 Attribute)
(documentation detectsMonitoringSystem EnglishLanguage
  "detectsMonitoringSystem(?actor, ?pattern, ?mon, ?sig, ?basis) holds
   when CyberActor ?actor shows AntiDetectionBehavior ?pattern indicating
   recognition of MonitoringSystem ?mon, generating DetectionSignal
   ?sig (i.e. the actor is detecting the defender).")

(instance adaptsBehaviorToMonitoring SenaryPredicate)
-domain adaptsBehaviorToMonitoring 1 CyberActor)
(domain adaptsBehaviorToMonitoring 2 CyberOperation)
(domain adaptsBehaviorToMonitoring 3 MonitoringSystem)
(domain adaptsBehaviorToMonitoring 4 AntiDetectionBehavior)
(domain adaptsBehaviorToMonitoring 5 DetectionSignal)
(domain adaptsBehaviorToMonitoring 6 Attribute)
(documentation adaptsBehaviorToMonitoring EnglishLanguage
  "adaptsBehaviorToMonitoring(?actor, ?op, ?mon, ?pattern, ?sig, ?basis)
   holds when CyberActor ?actor changes timing, volume, or patterns of
   CyberOperation ?op in response to MonitoringSystem ?mon in a way
   categorized as AntiDetectionBehavior ?pattern, generating
   DetectionSignal ?sig.")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; HIGH-LEVEL DETECTION RULE EXAMPLES (SCHEMATIC)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; 1. If an actor performs many prompt-like modifications to model
;;    context with control-phrase patterns, treat as PromptInjectionAttack.

(=> (and (performsInjectionAttack ?actor ?pattern ?endpoint ?payload ?op ?basis)
         (instance ?endpoint ModelEndpoint)
         (instance ?pattern PromptInjectionAttack))
    (detectionSignalFor PromptInjectionPattern ?pattern ?payload 0.8
                        "model-prompt-heuristic"))

;; 2. If we see exfiltration volume spikes plus new persistence indicators,
;;    raise compromise suspicion.

(=> (and (exfiltrationVolumeScore ?host ?store ?score ?sig1 ?b1)
         (greaterThan ?score 0.8)
         (persistenceIndicatorOfCompromise ?host ?pers ?sig2 ?pScore ?b2)
         (greaterThan ?pScore 0.5))
    (alignmentRiskProfile ?host "cyber-context" ExfiltrationScenario HighRisk
                          "exfil+pers-heuristic"))

;; 3. If a CyberActor both detects sandbox/monitoring and adapts its
;;    behavior, treat as AntiAnalysisBehavior relevant to AI alignment
;;    concerns (e.g. model detecting probes).

(=> (and (detectsMonitoringSystem ?actor ?pat1 ?mon ?sigA ?bA)
         (adaptsBehaviorToMonitoring ?actor ?op ?mon ?pat2 ?sigB ?bB))
    (hasCognitiveSafetyProperty ?actor AntiAnalysisConcern "cyberops-flag"))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; END OF CyberOps.kif
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
